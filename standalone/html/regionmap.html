<!DOCTYPE html>
<html>
<head>
	<!--meta charset="iso-8859-15"/-->
	<meta charset="UTF-8"/>
	<title>Example SVG map using D3.js to update fill color</title>
	<script type="text/javascript">
/**
 * load svg file
 **/
function initialize() {
	d3.xml("regionmap.svg", "image/svg+xml", function(error, xml) {
		updateFillColor(xml);
		if (error) throw error;
			document.body.appendChild(xml.documentElement);
		});
}
/**
 * Handles onClick
 **/
function onClickTest() {
	updateFillColor(document);
}
/**
 * Updates all regions
 **/
function updateFillColor(dom) {
	var sum=0;
	var percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Heilbronn-Franken", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Rhein-Neckar-Odenwald", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Mittlerer_Oberrhein", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Ludwigsburg-Rems-Murr", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Nordschwarzwald", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Ostw\u00fcrttemberg", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Stuttgart-B\u00f6blingen", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Neckar-Fils", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("S\u00fcdlicher_Oberrhein", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Ulm-Biberach", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Neckar-Alb", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Schwarzwald-Baar-Heuberg", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Bodensee-Oberschwaben", percent, dom);
	percent=getPercent();
	sum+=percent;
	fillRegionByPercent("Hochrhein-Bodensee", percent, dom);
	var average=Math.floor(sum/14);
	fillRegionByPercent("Baden-W\u00fcrttemberg", average, dom);
	showAverage(average);
}
/**
 * Changes a specific region color
 **/
function fillRegionByPercent(regionID, regionPercent, dom) {
	var element = dom.getElementById(regionID);
	var regionColor='none';
	if (regionPercent>=100) {
		regionColor='green';
	}
	else if (regionPercent<=90) {
		regionColor='red';
	}
	else {
		regionColor='yellow';
	}
	element.setAttribute('style', 'fill:'+regionColor+';stroke:#000000;stroke-width:1');
}
/**
 * gets the Data by using Math.random
 **/
function getPercent() {
	return Math.floor((Math.random() * 30) + 80);
}
/**
 * Displays average
 **/
function showAverage(average) {
	var element = document.getElementById("average");
	element.innerHTML = "Average: "+average;
}
	</script>
	<script type="text/javascript">
function handleMouseOver(element) {
	element.setAttribute("fill-opacity","0.5");
};
function handleMouseOut(element) {
	element.setAttribute("fill-opacity","1")
};
function handleMouseClick(element) {
	alert(element.id);
};
function svgMouseOver(evt) {
	handleMouseOver(evt.target);
};
function svgMouseOut(evt) {
	handleMouseOut(evt.target);
};
function svgMouseClick(evt) {
	handleMouseClick(evt.target);
};
function getSvgElementByTextEvent(evt) {
	return document.getElementById(evt.target.id.substring(11,evt.target.id.lastIndexOf("-X")));
};
function svgTextMouseOver(evt) {
	handleMouseOver(getSvgElementByTextEvent(evt));
};
function svgTextMouseOut(evt) {
	handleMouseOut(getSvgElementByTextEvent(evt));
};
function svgTextMouseClick(evt) {
	handleMouseClick(getSvgElementByTextEvent(evt));
};
	</script>
</head>
<body>
	<!--img id="regionmap" src="regionmap.svg"/-->
	<script src="../d3/d3.min.js" charset="utf-8" type="text/javascript"></script>
	<script type="text/javascript">initialize();</script>
	<button id="Test" onClick="onClickTest()">Test</button>
	<div id="average"></div>
</body>
</html>